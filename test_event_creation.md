# 事件创建功能测试指南

## 问题诊断和修复

### 发现的问题
1. **ID类型不匹配**: Event模型使用Int类型的id，但Firestore返回String类型的文档ID
2. **事件保存后缺少ID**: 新创建的事件没有正确设置ID字段
3. **事件获取时解析失败**: fetchEvents方法无法正确解析Firestore中的事件数据

### 修复方案
1. **修改addEvent方法**: 
   - 保存事件后获取Firestore生成的文档ID
   - 将文档ID转换为Int类型（使用哈希值）
   - 更新事件记录包含正确的ID

2. **修改fetchEvents方法**:
   - 添加错误处理和日志记录
   - 确保所有事件都有有效的ID
   - 对于缺少ID的旧事件，自动生成ID

### 测试步骤
1. 打开应用并登录
2. 进入日历界面
3. 点击右上角的"+"按钮或双击某个日期
4. 填写事件信息：
   - 标题：测试事件
   - 开始时间：当前时间
   - 结束时间：当前时间+1小时
   - 地点：测试地点
5. 点击保存
6. 检查事件是否成功显示在日历中
7. 尝试编辑和删除事件

### 预期结果
- 事件创建成功，无错误提示
- 事件正确显示在日历界面
- 事件数据完整，包含正确的ID
- 可以正常编辑和删除事件

### 如果仍有问题
检查以下方面：
1. Firebase配置是否正确
2. 网络连接是否正常
3. 用户认证状态
4. Firestore权限设置
5. 查看Xcode控制台的错误日志